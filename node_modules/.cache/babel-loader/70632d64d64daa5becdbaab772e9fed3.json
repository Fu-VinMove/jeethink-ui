{"remainingRequest":"/Users/fuwenmu/Downloads/jeethink前后分离开发框架/jeethink快速开发框架（前后分离）_V2.3/jeethink-ui/node_modules/thread-loader/dist/cjs.js!/Users/fuwenmu/Downloads/jeethink前后分离开发框架/jeethink快速开发框架（前后分离）_V2.3/jeethink-ui/node_modules/babel-loader/lib/index.js!/Users/fuwenmu/Downloads/jeethink前后分离开发框架/jeethink快速开发框架（前后分离）_V2.3/jeethink-ui/src/store/modules/user.js","dependencies":[{"path":"/Users/fuwenmu/Downloads/jeethink前后分离开发框架/jeethink快速开发框架（前后分离）_V2.3/jeethink-ui/src/store/modules/user.js","mtime":1590989844000},{"path":"/Users/fuwenmu/Downloads/jeethink前后分离开发框架/jeethink快速开发框架（前后分离）_V2.3/jeethink-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuwenmu/Downloads/jeethink前后分离开发框架/jeethink快速开发框架（前后分离）_V2.3/jeethink-ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuwenmu/Downloads/jeethink前后分离开发框架/jeethink快速开发框架（前后分离）_V2.3/jeethink-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { login, logout, getInfo } from '@/api/login';\nimport { getToken, setToken, removeToken } from '@/utils/auth';\nvar user = {\n  state: {\n    token: getToken(),\n    name: '',\n    avatar: '',\n    roles: [],\n    permissions: []\n  },\n  mutations: {\n    SET_TOKEN: function SET_TOKEN(state, token) {\n      state.token = token;\n    },\n    SET_NAME: function SET_NAME(state, name) {\n      state.name = name;\n    },\n    SET_AVATAR: function SET_AVATAR(state, avatar) {\n      state.avatar = avatar;\n    },\n    SET_ROLES: function SET_ROLES(state, roles) {\n      state.roles = roles;\n    },\n    SET_PERMISSIONS: function SET_PERMISSIONS(state, permissions) {\n      state.permissions = permissions;\n    }\n  },\n  actions: {\n    // 登录\n    Login: function Login(_ref, userInfo) {\n      var commit = _ref.commit;\n      var username = userInfo.username.trim();\n      var password = userInfo.password;\n      var code = userInfo.code;\n      var uuid = userInfo.uuid;\n      return new Promise(function (resolve, reject) {\n        login(username, password, code, uuid).then(function (res) {\n          setToken(res.token);\n          commit('SET_TOKEN', res.token);\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 获取用户信息\n    GetInfo: function GetInfo(_ref2) {\n      var commit = _ref2.commit,\n          state = _ref2.state;\n      return new Promise(function (resolve, reject) {\n        getInfo(state.token).then(function (res) {\n          var user = res.user;\n          var avatar = user.avatar == \"\" ? require(\"@/assets/image/profile.jpg\") : process.env.VUE_APP_BASE_API + user.avatar;\n\n          if (res.roles && res.roles.length > 0) {\n            // 验证返回的roles是否是一个非空数组\n            commit('SET_ROLES', res.roles);\n            commit('SET_PERMISSIONS', res.permissions);\n          } else {\n            commit('SET_ROLES', ['ROLE_DEFAULT']);\n          }\n\n          commit('SET_NAME', user.userName);\n          commit('SET_AVATAR', avatar);\n          resolve(res);\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 退出系统\n    LogOut: function LogOut(_ref3) {\n      var commit = _ref3.commit,\n          state = _ref3.state;\n      return new Promise(function (resolve, reject) {\n        logout(state.token).then(function () {\n          commit('SET_TOKEN', '');\n          commit('SET_ROLES', []);\n          commit('SET_PERMISSIONS', []);\n          removeToken();\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 前端 登出\n    FedLogOut: function FedLogOut(_ref4) {\n      var commit = _ref4.commit;\n      return new Promise(function (resolve) {\n        commit('SET_TOKEN', '');\n        removeToken();\n        resolve();\n      });\n    }\n  }\n};\nexport default user;",null]}